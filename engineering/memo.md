# serverless

## What?

- アプリケーションサーバー … 常駐型プロセスを実行するインフラストラクチャ
- サーバレスアーキテクチャ … 「非常駐型プロセス」をイベントによってトリガーするインフラストラクチャ

常駐型プロセス => サーバー内に既に置いてあるファイルなど

## 使用事例

### AWS lambda

- クラウド上でアプリケーションを実行する新たなプラットフォーム
- 何らかのイベントをトリガーに事前に用意した処理を実行することが可能

  (ex:イベント)

  - S3 へのアップロード
  - DynamoDB のデータ更新

- インフラの管理をする必要がない
  - EC2 インスタンスの設定不要
  - イベントトリガーのため、起動・管理不要
  - 環境設定不要
  - オートスケーリング = イベントの発生レートに応じて自動でスケールをコントロールしてくれる

=> アプリケーションの開発と Lambda ファンクションとしてアップロードするだけいい。

(従来)

- イベントドリブンなアプリケーションの作成には手間がかかった

  (ex)

  - 変更を検知するためにポーリングし続ける仕組みの構築
    - ポーリング … 一定時間ごとに、機器やソフトウェアなどの状況を確認し、何らかの処理を行なう状態になったと判断したらそれを行なう方式。
  - 変更を検知したらそれに応じた適切な処理を行う仕組みを独自に実装

- インフラの構築管理の手間もかかった
  - AWS の場合、EC2 インスタンスの設定や OS や言語などの環境設定、起動、監視、スケール化などなど

#### lambda ファンクション

- トリガーに対して実行する関数
- ステートレスに記述する必要がある
  - Lambda ファンクションは内部的にはコンテナとして実行されており、起動の都度生成され（一部例外はあるものの）終了時には破棄されるから
  - => Lambda ファンクション自身ではデータを永続化することができません

(記述方法)

- マネージメントコンソール画面上に用意されている組み込みエディタを使用
- ローカル PC などで書いたコードを Zip 形式にしてアップロードする

  - ライブラリなども一緒に Zip 形式でアップロードが必要

- 実行のタイムアウト時間を設定する必要がある
  - デフォルトで 3 秒
  - 1~60 まで 1 秒刻み  
    => 比較的シンプルで小規模な処理をイベント発生ごとに実行するイベントドリブンアーキテクチャのためのプラットフォーム  
     既存のバッチジョブを代替するプラットフォームではないということ
